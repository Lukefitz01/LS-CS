<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <title>Past Results</title>
</head>

<body>
    <header class="header">
        <div class="">
            <div class="">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="whatif.html">What if</a></li>
                    <li><a href="graph.html">Past Results</a></li>
                    <li><a href="a.html">Placeholder</a></li>
                </ul>
            </div>

        </div>

    </header>
    <canvas id="myChart" style="width:100%;max-width:90%"></canvas>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";



        const firebaseConfig = {
            apiKey: "AIzaSyADFbm7eOAYc9ikVduSPEF_i_sKDDpfRY8",
            authDomain: "fire10db-5cdc9.firebaseapp.com",
            databaseURL: "https://fire10db-5cdc9-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "fire10db-5cdc9",
            storageBucket: "fire10db-5cdc9.appspot.com",
            messagingSenderId: "754388872821",
            appId: "1:754388872821:web:b3ff18d3df16964eac123c"
        };


        const app = initializeApp(firebaseConfig);

        import { getDatabase, ref, set, get, child, update, remove }
            from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"

        const db = getDatabase();
        const dbRef = ref(db);
        let R1 = 0
        let R2 = 0
        let R3 = 0
        let R4 = 0
        let R5 = 0
        let R6 = 0
        let R7 = 0
        let R8 = 0
        let R9 = 0
        let R10 = 0

        let R1n = 0
        let R2n = 0
        let R3n = 0
        let R4n = 0
        let R5n = 0
        let R6n = 0
        let R7n = 0
        let R8n = 0
        let R9n = 0
        let R10n = 0
//
        let var1 = 0
        get(child(dbRef, 'ProjReactionLog/')).then((snapshot) => {
            if (snapshot.exists()) {
                // need to get previous 10 R times
                snapshot.forEach((childSnapshot) => {
                    let childKey = childSnapshot.key;
                    let childDataTime = childSnapshot.val().ReactionTime;
                    //const childDataTemp = childSnapshot.val().Temp;

                    console.log(childKey, childDataTime);
                    if (childDataTime.length  == 2){
                        childDataTime = "0.0" + childDataTime
                    }
                    else{
                        childDataTime = "0." + childDataTime
                    }
                    
                    console.log(childKey, childDataTime);
                    if (var1 == 0) {
                        R1n = childKey;
                        R1 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 1) {
                        R2n = childKey;
                        R2 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 2) {
                        R3n = childKey;
                        R3 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 3) {
                        R4n = childKey;
                        R4 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 4) {
                        R5n = childKey;
                        R5 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 5) {
                        R6n = childKey;
                        R6 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 6) {
                        R7n = childKey;
                        R7 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 7) {
                        R8n = childKey;
                        R8 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 8) {
                        R9n = childKey;
                        R9 = childDataTime;

                        var1 = var1 + 1
                    }
                    else if (var1 == 9) {
                        R10n = childKey;
                        R10 = childDataTime;

                        var1 = var1 + 1
                    }




                })
                console.log("PROJRLOG", R1,R1n, R10, R10n);

            }
            else {
                alert("data no exist 3 ")
            }

            console.log(R1,R2, R3, R4);
        const xValues = [R1n, R2n, R3n, R4n, R5n, R6n, R7n, R8n, R9n, R10n]; // put random nums from db in here
        const yValues = [R1, R2, R3, R4, R5, R6, R7, R8, R9, R10];
        let barColors = ["red", "green", "blue", "orange", "brown", "red", "green", "blue", "orange", "brown"]; // fine

        new Chart("myChart", {
            type: "line",
            data: {
                labels: xValues,
                datasets: [{
                    backgroundColor: barColors,
                    data: yValues
                }]
            },
            options: {
                legend: { display: false },
                title: {
                    display: true,
                    text: "Reaction Time History"
                }
            }
        });
        })
        //const xValues = [50,60,70,80,90,100,110,120,130,140,150];
        //const yValues = [7,8,8,9,9,9,10,11,14,14,15];
        //let xValues = [R1n, R2n, R3n, R4n, R5n, R6n, R7n, R8n, R9n, R10n]; // put random nums from db in here
        //let yValues = [R1, R2, R3, R4, R5, R6, R7, R8, R9, R10]; // put rtimes in here
        
        
        console.log(R1,R2, R3, R4);
        const xValues = [R1n, R2n, R3n, R4n]; // put random nums from db in here
        const yValues = [R1, R2, R3, R4];
        let barColors = ["red", "green", "blue", "orange", "brown", "red", "green", "blue", "orange", "brown"]; // fine

        
    </script>
</body>

</html>